<!DOCTYPE html>
<html lang="en" style="background-color:rgb(34, 33, 32)">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowable - graph explorer</title>
    <link rel="stylesheet" href="knowable.css">
</head>
<body>
    <table id="sizer-table" style="border:0; display:none;">
        <tr>
            <td nowrap>
                <div id="dream" style="font-size:larger;">d r e a m<br>d r e a m</div>
            </td>
        </tr>
    </table>

    <table style="width:100%; height:100%;">
        <tr>
            <td>
                <div id="dream-body" style="margin: auto; ">
                    <div style="float:right; ">
                        <button id="grid-button" style="margin: 5px; ">grid</button>
                    </div>
                </div>
            </td>
        </tr>
    </table>
</body>
<script type="module">
    import templateService from './template-service.js';
    import layoutService from './layout-service.js';
    import resizeService from './resize-service.js';
    import gridService from './grid-service.js';
    import serverConnection from './server-connection.js';
    import commonCommandHandlers from './common-command-handlers.js';

    // Get command handlers from the common module
    const commandHandlers = commonCommandHandlers.getHandlers();

    function initGridButton() {
        document.getElementById("grid-button").addEventListener("click", ()=>gridService.toggleGrid());
    }

    // Initialize the application
    window.onload = async function () {
        resizeService.init();
        layoutService.init();
        initGridButton();

        // Load templates
        await templateService.loadTemplateFile('dream-templates.html');
        
        // Connect to server with command handlers
        serverConnection.connectWebSocket(commandHandlers, "dream");
    }
</script>
</html>